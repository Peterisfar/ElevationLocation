import matplotlib.pylab as plt
import csv
import numpy as np
import math
from utils.tools import *


# 09-59-19
# x0 = 112.808
# y0 = 28.1604
# yaw0 = 222

# 10-27-21
# x0 = 112.76108
# y0 = 28.1493
# yaw0 = 356.36

# 10-27-23
# x0 = 112.7611
# y0 = 28.1493
# yaw0 = 7.85001

# 10-27-25
# x0 = 112.7611
# y0 = 28.1493
# yaw0 = 16.57

# 10-27-28
# x0 = 112.7611
# y0 = 28.1493
# yaw0 = 28.29
name = "10_27_35_new"
# 10-27-35
x0 = 112.7611
y0 = 28.1493
yaw0 = 57.74

# 10-27-37
# x0 = 112.7611
# y0 = 28.1494
# yaw0 = 77.78

# 10-27-40
# x0 = 112.7611
# y0 = 28.1493
# yaw0 = 90.8

# 10-27-42
# x0 = 112.7611
# y0 = 28.1493
# yaw0 = 105.35

# 10-27-46
# x0 = 112.7611
# y0 = 28.1494
# yaw0 = 126.2

# 10-29-17
# x0 = 112.7573
# y0 = 28.1518
# yaw0 = 223.0

# 10-29-35
# x0 = 112.7574
# y0 = 28.1518
# yaw0 = 296.77

# 10-30-10
# x0 = 112.7574
# y0 = 28.1518
# yaw0 = 71.09

# 10-30-12
# x0 = 112.7574
# y0 = 28.1518
# yaw0 = 80.58

# 10-30-17
# x0 = 112.7574
# y0 = 28.1518
# yaw0 = 83.23

# 10-30-35
# x0 = 112.7574
# y0 = 28.1518
# yaw0 = 127.99

# 10-31-44
# x0 = 112.7560
# y0 = 28.1526
# yaw0 = 190.98

# 10-31-46
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 202.12

# 10-32-38
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 14.24
# name = "10_32_40_new"
# 10-32-40
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 25.22

# 10-32-41
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 31.66

# 10-32-44
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 31.66

# 10-32-58
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 89.87

# 10-33-01
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 103.97

# 10-33-04
# x0 = 112.7559
# y0 = 28.1526
# yaw0 = 106.74

# 10-49-50
# x0 = 112.7096
# y0 = 28.1490
# yaw0 = 359.94

# 10-49-52
# x0 = 112.7096
# y0 = 28.1490
# yaw0 = 12.33

# 10-49-54
# x0 = 112.7096
# y0 = 28.1490
# yaw0 = 21.46

# 10-50-04
# x0 = 112.7096
# y0 = 28.1490
# yaw0 = 8.91

# 10-50-09
# x0 = 112.7096
# y0 = 28.1490
# yaw0 = 19.21

# 10-55-53
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 344.15

# 10-55-56
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 356.42

# 10-55-58
# x0 = 112.7574
# y0 = 28.15135
# yaw0 = 4.67999

# 10-56-02
# x0 = 112.7574
# y0 = 28.15135
# yaw0 = 24.64

# 10-56-10
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 66.52

# 10-56-12
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 77.3

# 10-56-17
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 103.72

# 10-56-19
# x0 = 112.7574
# y0 = 28.1513
# yaw0 = 116.3



csv_file = csv.reader(open("./data/locdata/{}.csv".format(name), 'r'))

X = np.arange(112.69000, 112.83000, 0.002)
Y = np.arange(28.08000, 28.22000, 0.002)
X, Y = np.meshgrid(X, Y)

Z = np.zeros((len(X[0]),len(Y[0])))

for i, data in enumerate(csv_file):
    if i == 0:
        continue
    lat, lon, score, yaw= list(map(float, data[1:]))
    if score > 0.6 and get_yaw_in_area(yaw, yaw0, 50):
        row = int((lon - 112.6900) / 0.002)
        col = int((lat - 28.08000) / 0.002)
        Z[col, row] = score  # numpy存储方向相反

        length = math.sqrt((lon-x0)**2 + (lat-y0)**2) / 0.002 * 200
        print(data[0], lat, lon, score, length)

# Z = np.clip(Z,0.7,1)
plt.contourf(X, Y, Z, 8)
plt.colorbar(shrink=.83)

plt.scatter([x0,],[y0],s = 20, color='b')
plt.show()